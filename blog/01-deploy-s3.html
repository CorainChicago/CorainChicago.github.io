<!DOCTYPE html>
<html>
<head>
  <title>Cora Hays-Magan</title>
  <link href='http://fonts.googleapis.com/css?family=Karla:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="../default.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head> 
<body>
  <header>
    <h1>Cora Hays-Magan</h1>
    <img id="profile" src="../imgs/profile.jpg">
    <nav>
        <h2><a href="http://corainchicago.github.io/">Home</a><h2>
        <h2><a href="http://corainchicago.github.io/#writing">Writing</a></h2>
        <h2><a href="http://corainchicago.github.io/portfolio.html">Portfolio</a></h2>
        <h2><a href="http://corainchicago.github.io/resume.html">Resume</a></h2>
        <h2><a href="http://corainchicago.github.io/about.html">About Me</a></h2>
      </nav>
      <h3>An enthusiastic coder</h3>
  </header>
  <section>
	  <h1>Rails + Carrierwave + Fog + Amazon s3</h1>
	  <h2>Putting these things all together</h2>
	  <h4>July 12, 2016</h4>
	 </section> 
<section>
  <p>Normally, I use Carrierwave + Cloudinary to upload, store and retrieve photos in Rails applications.  RailsBridge Chicago has a great set of instructions on <a href="http://curriculum.railsbridgechi.com/intro-to-rails/pictures">how to set this up</a>. I wanted to start using Amazon Web Services more so I decided to convert my photo upload to an S3 bucket.</p>

  <p>After a bit of frustration, reading through documentation and stackoverflow answers, and creating then deleting buckets and user keys, I got it to work.</p>

  <p>Here's the steps from the front to back of a Rails app.</p>

  <ol>
    <li><h3>Add the upload to the form for the object in the view</h3>
      <pre>
        <code>
          <div class="field">
            <%= f.label :image %><br>
            <%= f.file_field :image %>
          </div>
        </code>
      </pre>
      </li>
    <li><h3>Install Gems</h3>
      <pre>
        <code>
          # For photo upload
          gem 'carrierwave','0.10.0'
          # Connects to the S3 account
          gem 'fog'
          # Library for image manipulation
          gem "mini_magick"
        </code>
      </pre>
      <p>Remember to run `bundle install` or your terminal will yell at you.</p>
    </li>
    <li><h3>Install Carrierwave and create uploader (use the <a href="https://github.com/carrierwaveuploader/carrierwave">Carrierwave docs</a> - they are great for this).</h3>
      <p>Run `rails generate uploader Image' to create the image uploader (or name it Photos or anything else you like. </p>
      <p>Add the uploader to the object needing the image.  For example: `rails g migration add_image_to_dogs image:string' adds the image field to the dogs table. </p>
      <p>Mount the uploader in the Model for the table. For example in `models/dogs.rb`:</p>
        <pre>
          <code>
            class Dog < ActiveRecord::Base
                mount_uploader :image, ImageUploader
            end
          </code>
        </pre>
    </li>
    <li><h3>Uploader File</h3>
      <p> When you ran the command `rails g uploader Image`, a folder and file was created in your application. Look at `app/uploaders/image_uploader.rb`.  Notice all the commented out code and read through what it does (rather handy and remember to be appreciative of all the open source contributors and maintainers who make gems like this). </p>
      <p>Here are the minimum lines to uncomment: </p>
      <p>`include CarrierWave::MiniMagick` - This pulls in the MiniMagick library to make photo manipulation a breeze. </p>
      <p>`</p>

    </li>
    <li></li>
    <li></li>
  </ol>





</section>
<footer>
		<p>Contact Me: I code, I pair, and I share</p>
		<address><a href="mailto: chaysmagan@gmail.com"> <img class ='icon' src="../imgs/Mail.png"></a>
		<a href="https://twitter.com/CorainChicago"><img class ='icon' src="../imgs/Twitter.png"></a>
		<a href="https://github.com/CorainChicago"><img class ='icon' src="../imgs/Github.png"></a>
		<a href="https://www.linkedin.com/pub/cora-hays-magan/1a/532/577"><img class ='icon' src="../imgs/Linkedin.png"></a>
		<a href ="https://speakerdeck.com/corainchicago"><img class ='icon' src="../imgs/speakerdeck.png"></a>
		</address>
	</footer>
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	
	  ga('create', 'UA-51171819-3', 'auto');
	  ga('send', 'pageview');
	</script>
</body>
</html>
